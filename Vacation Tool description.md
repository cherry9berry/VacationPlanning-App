# Vacation Tool - Документация проекта

## Общее описание

**Vacation Tool** - настольное приложение на Python с графическим интерфейсом (Tkinter) для автоматизации создания и управления файлами планирования отпусков сотрудников в организации.

## Бизнес-логика

### Основная задача
Массовое создание персональных Excel-файлов для планирования отпусков сотрудников на основе данных штатного расписания.

### Бизнес-процесс
1. **HR-специалист** загружает файл Excel с данными сотрудников (штатное расписание)
2. **Система** валидирует данные и создает структуру папок по подразделениям
3. **Для каждого сотрудника** создается персональный файл на основе шаблона
4. **Сотрудники** заполняют свои файлы, планируя отпуска
5. **Кураторы отделов** обновляют отчеты по блокам (в разработке)
6. **HR-специалист** обновляет отчет по всем блокам (в разработке)

### Ключевые особенности
- **Работа с существующими структурами**: Система не перезаписывает уже созданные файлы, а дополняет структуру новыми сотрудниками
- **Гибкость шаблонов**: Использование настраиваемых Excel-шаблонов
- **Валидация данных**: Проверка корректности входных данных
- **Отчетность**: Создание отчетов по заполнению планов отпусков (в разработке)

## Архитектура

### Структура проекта
```
project/
├── main.py                 # Точка входа
├── config.py              # Конфигурация
├── config.json            # Настройки
├── models.py              # Модели данных
├── core/                  # Основная логика
│   ├── processor.py       # Главный процессор
│   ├── validator.py       # Валидация данных
│   ├── excel_handler.py   # Работа с Excel
│   ├── file_manager.py    # Управление файлами
│   └── build_script.py    # Сборка
├── gui/                   # Интерфейс
│   ├── main_window.py     
│   ├── create_files_window.py
│   └── reports_window.py  
├── templates/             # Шаблоны Excel
│   ├── employee_template.xlsx
│   ├── block_report_template.xlsx
│   └── global_report_template.xlsx
└── logs/                  # Логи
    └── vacation_tool.log
```

### Основные компоненты

#### **Процессор (processor.py)**
Главный компонент, координирующий операции:
- `create_employee_files_to_existing()` - создание файлов в существующей структуре
- `update_block_reports()` - обновление отчетов по подразделениям (в разработке)
- `create_general_report()` - создание общего отчета (в разработке)
- `get_processing_statistics()` - получение статистики для предпросмотра

#### **Валидатор (validator.py)**
Проверка данных:
- Валидация структуры Excel файлов
- Проверка обязательных полей
- Контроль уникальности табельных номеров
- Проверка наличия шаблонов

#### **Обработчик Excel (excel_handler.py)**
Работа с Excel:
- Создание файлов сотрудников на основе шаблонов
- Чтение данных об отпусках (в разработке)
- Создание отчетов (в разработке)

#### **Менеджер файлов (file_manager.py)**
Управление файловой системой:
- Создание структуры папок по подразделениям
- Сканирование существующих файлов
- Логика "доливки" новых сотрудников в существующие папки

## Форматы данных

### Входной файл (штатное расписание)
- **Формат**: Excel (.xlsx, .xls)
- **Заголовки**: в 5-й строке (настраивается)
- **Обязательные столбцы**:
  - "ФИО работника"
  - "Табельный номер"
  - "Подразделение 1"
- **Дополнительные Обязательные столбцы**: "Подразделение 2", "Подразделение 3", "Подразделение 4"

### Выходные файлы сотрудников
- **Формат**: Excel (.xlsx)
- **Название**: `ФИО (табельныйНомер).xlsx`
- **Содержимое**: Персональные данные + таблица для планирования отпусков (строки 9-23)

### Отчеты (в разработке)
- **Отчет по подразделению**: `! Отчет по заполнению.xlsx`
- **Общий отчет**: `ОБЩИЙ_ОТЧЕТ.xlsx`

## Логика работы с существующими файлами

### Алгоритм "доливки"
1. **Сканирование** целевой папки на предмет существующих подразделений
2. **Подсчет** уже созданных файлов сотрудников
3. **Определение** новых сотрудников (кого нет в папках)
4. **Создание** только недостающих файлов
5. **Сохранение** существующей структуры папок

### Логика активации кнопок
- Кнопка "Создать файлы" активна только при наличии новых сотрудников
- Если все записи уже есть - кнопка неактивна
- Отображение точного количества файлов к созданию

## Бизнес-правила

### Создание файлов
- Один файл на одного сотрудника
- Группировка по подразделениям (папки)
- Не перезаписывать существующие файлы
- "Доливать" только новых сотрудников

### Валидация данных
- Уникальность табельных номеров
- Обязательность ФИО и подразделения
- Ограничения по количеству записей (1-10000)
- Проверка формата файлов

### Отчетность (в разработке)
- будет заполняться шаблон отчета xlsx по файлам людей из графика

## Конфигурация

### Настраиваемые параметры (config.json)
```json
{
  "employee_template": "templates/employee_template.xlsx",
  "block_report_template": "templates/block_report_template.xlsx",
  "general_report_template": "templates/global_report_template.xlsx",
  "header_row": 5,
  "processing_time_per_file": 0.3,
  "excel_password": "1111",
  "date_format": "%d.%m.%y",
  "max_employees": 10000,
  "min_employees": 1,
  "window_width": 1000,
  "window_height": 700,
  "log_level": "INFO"
}
```

## Пользовательский интерфейс

### Главное окно
- **Статус шаблонов**: Проверка наличия необходимых файлов
- **Кнопка создания файлов**: Запуск основной функции
- **Кнопка отчетов**: В разработке
- **Инструкции**: Пошаговое руководство

### Окно создания файлов
- **Выбор файлов**: Штатное расписание и целевая папка
- **Валидация**: Автоматическая проверка данных
- **Статистика**: Информация о количестве записей и подразделений
- **Прогресс**: Детальное отображение хода выполнения
- **Результат**: Сводка выполненной операции

### Окно отчетов
В разработке. Планируется:
- Обновление отчетов по подразделениям
- Обновление общего отчета

## Обработка ошибок и логирование

### Типы логов
- **INFO**: Общая информация о ходе выполнения
- **WARNING**: Предупреждения о некритичных проблемах
- **ERROR**: Ошибки, требующие внимания

### Файл логов
- Местоположение: `logs/vacation_tool.log`
- Формат: Дата/время, компонент, уровень, сообщение
- Кодировка: UTF-8

## Технические требования

### Зависимости
- `tkinter`: Графический интерфейс
- `openpyxl`: Работа с Excel файлами
- `pathlib`: Работа с путями файлов
- `logging`: Система логирования
- `threading`: Многопоточность для UI

### Системные требования
- Python 3.7+
- Windows/Linux
- Наличие xlsx шаблонов в папке templates/


### Принципы разработки
- **Модульность**: Четкое разделение ответственности
- **Конфигурируемость**: Настройки через config.json
- **Расширяемость**: Возможность добавления новых функций
- **Безопасность**: Валидация всех входных данных